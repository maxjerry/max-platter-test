{% doc %}
  Renders star rating with partial fill based on decimal rating.

  @param {number} rating - The rating value (e.g., 4.2, 3.7)
  @param {number} review_count - Number of reviews
  @param {string} product_id - Unique product ID for gradient
  @param {number} index - Card index for unique gradient ID

  @example
  {% render 'star-rating', 
    rating: 4.2, 
    review_count: 150,
    product_id: product.id,
    index: forloop.index
  %}
{% enddoc %}

{% if rating == blank %}
  {% assign rating = 5 %}
{% endif %}
{% if review_count == blank %}
  {% assign review_count = 235 %}
{% endif %}

{% assign rating_value = rating | times: 1.0 %}
{% assign full_stars = rating_value | floor %}
{% assign remainder = rating_value | minus: full_stars %}
{% assign remainder_percent = remainder | times: 100 | round %}
{% assign empty_stars = 5 | minus: full_stars %}

{% if remainder > 0 %}
  {% assign has_partial_star = true %}
  {% assign empty_stars = empty_stars | minus: 1 %}
{% else %}
  {% assign has_partial_star = false %}
{% endif %}

<div class="flex items-center gap-2 text-sm">
  <div class="flex items-center gap-0.5">
    <!-- Full stars -->
    {% for i in (1..full_stars) %}
      {% render 'icon-star-full' %}
    {% endfor %}
    
    <!-- Partial star -->
    {% if has_partial_star %}
      {% render 'icon-star-partial', 
        product_id: product_id,
        index: index,
        remainder_percent: remainder_percent
      %}
    {% endif %}
    
    <!-- Empty stars -->
    {% for i in (1..empty_stars) %}
      {% render 'icon-star-empty' %}
    {% endfor %}
  </div>
  
  <span class="text-medium-gray font-poppins font-normal text-xs">
    {{ review_count }} {{ 'products.reviews' | t }}
  </span>
</div>
